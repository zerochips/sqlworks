
CREATE TABLE A1(
    COL1 NUMBER(3)
);

CREATE TABLE B1(
    COL1 NUMBER(3)
);

CREATE TABLE C1(
    COL1 NUMBER(3)
);

INSERT INTO A1 VALUES(1);
INSERT INTO A1 VALUES(2);
INSERT INTO A1 VALUES(3);
INSERT INTO A1 VALUES(4);

INSERT INTO B1 VALUES(3);
INSERT INTO B1 VALUES(5);

INSERT INTO C1 VALUES(4);
INSERT INTO C1 VALUES(5);

SELECT * FROM A1
UNION 
SELECT * FROM B1
MINUS
SELECT * FROM C1;

/* JOIN - PARTITION */
CREATE TABLE MEDIA(
    MEDIA_CD    VARCHAR2(2 BYTE),
    MEDIA_NM    VARCHAR2(10 BYTE)
);

CREATE TABLE ORDER_HIST(
    ORD_DT  VARCHAR2(8 BYTE),
    MEDIA_CD VARCHAR2(2),
    ORD_AMT NUMBER(8, 0)
);

INSERT INTO MEDIA VALUES ('10', 'TV');
INSERT INTO MEDIA VALUES ('20', 'PC');
INSERT INTO MEDIA VALUES ('30', 'MOBILE');

INSERT INTO ORDER_HIST VALUES ('20190801', '10', 25000);
INSERT INTO ORDER_HIST VALUES ('20190801', '20', 40000);
INSERT INTO ORDER_HIST VALUES ('20190801', '20', 32000);
INSERT INTO ORDER_HIST VALUES ('20190801', '10', 12000);
INSERT INTO ORDER_HIST VALUES ('20190801', '30', 8000);
INSERT INTO ORDER_HIST VALUES ('20190802', '10', 31000);
INSERT INTO ORDER_HIST VALUES ('20190802', '10', 22800);
INSERT INTO ORDER_HIST VALUES ('20190802', '30', 25000);
INSERT INTO ORDER_HIST VALUES ('20190802', '30', 7900);
INSERT INTO ORDER_HIST VALUES ('20190802', '30', 250000);
INSERT INTO ORDER_HIST VALUES ('20190803', '10', 29000);
INSERT INTO ORDER_HIST VALUES ('20190803', '10', 10000);

-- 날짜별 매체별 주문금액

-- 주문 테이블
SELECT A.ORD_DT, B.MEDIA_NM, NVL(SUM(A.ORD_AMT), 0) AMT 
    FROM MEDIA B
    LEFT OUTER JOIN ORDER_HIST A PARTITION BY (A.ORD_DT)
      ON B.MEDIA_CD = A.MEDIA_CD
   GROUP BY ROLLUP(A.ORD_DT, B.MEDIA_NM)
   ORDER BY A.ORD_DT;

-- 매체 테이블
SELECT * FROM MEDIA;

-- JOIN
SELECT *
FROM ORDER_HIST H, MEDIA M
WHERE H.MEDIA_CD(+) = M.MEDIA_CD;

SELECT *
FROM ORDER_HIST H, MEDIA M
WHERE H.MEDIA_CD(+) = M.MEDIA_CD;








